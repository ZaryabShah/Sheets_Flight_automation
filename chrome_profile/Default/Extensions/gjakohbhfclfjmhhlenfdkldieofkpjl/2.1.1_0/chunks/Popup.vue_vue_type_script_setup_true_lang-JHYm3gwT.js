import{d as L,s as A,bb as O,bc as C,h as $,o as E,al as q,j as D,k as M,m as z,f as B,bp as R,bq as N,br as U,bs as K,bt as P,bu as V,a3 as j,a1 as G,c as T,p as x,i as J,u as Q,bv as W}from"./popup-Bk9gj0yf.js";const n={inert:":not([inert]):not([inert] *)",negTabIndex:':not([tabindex^="-"])',disabled:":not(:disabled)"},X=[`a[href]${n.inert}${n.negTabIndex}`,`area[href]${n.inert}${n.negTabIndex}`,`input:not([type="hidden"]):not([type="radio"])${n.inert}${n.negTabIndex}${n.disabled}`,`input[type="radio"]${n.inert}${n.negTabIndex}${n.disabled}`,`select${n.inert}${n.negTabIndex}${n.disabled}`,`textarea${n.inert}${n.negTabIndex}${n.disabled}`,`button${n.inert}${n.negTabIndex}${n.disabled}`,`details${n.inert} > summary:first-of-type${n.negTabIndex}`,`iframe${n.inert}${n.negTabIndex}`,`audio[controls]${n.inert}${n.negTabIndex}`,`video[controls]${n.inert}${n.negTabIndex}`,`[contenteditable]${n.inert}${n.negTabIndex}`,`[tabindex]${n.inert}${n.negTabIndex}`];function F(e,t){if(t.nodeType!==Node.ELEMENT_NODE)return null;if(t.matches(e))return t;const s=t.children;if(s.length>0)for(const a of s){const r=F(e,a);if(r)return r}const u=t.shadowRoot;if(u){const a=u.children;for(const r of a){const d=F(e,r);if(d)return d}}return null}const S=(e,t)=>t?.querySelector(e)??F(e,t),Y=()=>{let e=X;return"inert"in HTMLElement.prototype||(e=e.map(t=>t.replace(":not([inert]):not([inert] *)",""))),e.join(", ")},Z=Y(),p={Enter:"Enter",Esc:"Escape",ArrowUp:"ArrowUp",ArrowDown:"ArrowDown"},y=e=>e.matches(":focus-within"),_=e=>S(":focus",e),ee=e=>{const t=_(e);return t instanceof HTMLElement?(t.click(),!0):!1},te=e=>e?S(Z,e):null,ne=e=>e.nodeType===Node.ELEMENT_NODE,I=(e,t)=>{const s=e.composedPath();for(const u of s){let a=-1;if(ne(u)&&(a=t.indexOf(u)),a!==-1)return a}return-1},ce=L({__name:"List",props:{as:{default:"ul"},tabIndex:{default:()=>-1},defaultFocusIndex:{default:0},role:{},"aria-orientation":{}},setup(e){const t=A(),s=i=>t.value?.querySelector(`[data-list-container] > ${i}`)??null,u=i=>{const l=t.value;if(!l)return;const{code:f}=i,h=f===p.ArrowDown;if(h||f===p.ArrowUp){let m;if(l.matches(":focus"))m=s(h?":first-child":":last-child");else{const g=s(":focus-within");m=h?g?.nextElementSibling:g?.previousElementSibling}m instanceof HTMLElement&&m.focus()}else if(f===p.Enter){if(!ee(l))return}else return;i.preventDefault()},a=()=>[...t.value?.children??[]],r=(i,l)=>{const h=a()[i];h instanceof HTMLElement&&(h.tabIndex=l)},d=()=>{r(e.defaultFocusIndex,0)},b=i=>{if(!t.value)return;const l=a();let f=I(i,l);f===-1&&(f=e.defaultFocusIndex),r(f,0)},o=i=>{const l=t.value;if(!l)return;const f=I(i,a());r(f,-1),queueMicrotask(()=>{y(l)||d()})},c=new MutationObserver(()=>{t.value&&!y(t.value)&&d()});return O(()=>{const i=t.value;i&&(d(),c.observe(i,{childList:!0}))}),C(()=>{c.disconnect()}),(i,l)=>(E(),$(q(i.as),{ref_key:"container",ref:t,tabindex:i.tabIndex,"aria-orientation":["aria-orientation"],"data-list-container":"",onFocusin:b,onFocusout:o,onKeydown:u},{default:D(()=>[M(i.$slots,"default")]),_:3},40,["tabindex"]))}});function v(e,t,s,u=20,a=0){let r=[];if(a>=u)return r;const d=o=>{const c=o.assignedNodes().filter(i=>i.nodeType===1);return c.length>0?v(c[0].parentElement,t,s,u,a+1):[]},b=Array.from(e.children||[]);for(const o of b)t(o)||(s(o)&&r.push(o),o.shadowRoot!=null?r.push(...v(o.shadowRoot,t,s,u,a+1)):o.tagName==="SLOT"?r.push(...d(o)):r.push(...v(o,t,s,u,a+1)));return r}function k(e){return e.hasAttribute("hidden")||e.hasAttribute("aria-hidden")&&e.getAttribute("aria-hidden")!=="false"||e.style.display==="none"||e.style.opacity==="0"||e.style.visibility==="hidden"||e.style.visibility==="collapse"}function se(e){return e.hasAttribute("disabled")||e.hasAttribute("aria-disabled")&&e.getAttribute("aria-disabled")!=="false"}function oe(e){return e.getAttribute("tabindex")==="-1"||k(e)||se(e)?!1:e.hasAttribute("tabindex")||(e instanceof HTMLAnchorElement||e instanceof HTMLAreaElement)&&e.hasAttribute("href")||e instanceof HTMLButtonElement||e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement||e instanceof HTMLSelectElement||e instanceof HTMLIFrameElement}const w=new Map;function ie(e,t,s){const u=w.get(s);u!=null&&window.clearTimeout(u),w.set(s,window.setTimeout(()=>{e(),w.delete(s)},t))}const H=document.createElement("template");H.innerHTML=`
	<div id="start"></div>
	<div id="backup"></div>
	<slot></slot>
	<div id="end"></div>
`;class ae extends HTMLElement{constructor(){super(),this.debounceId=Math.random().toString(),this._focused=!1;const t=this.attachShadow({mode:"open"});t.appendChild(H.content.cloneNode(!0)),this.$backup=t.querySelector("#backup"),this.$start=t.querySelector("#start"),this.$end=t.querySelector("#end"),this.focusLastElement=this.focusLastElement.bind(this),this.focusFirstElement=this.focusFirstElement.bind(this),this.onFocusIn=this.onFocusIn.bind(this),this.onFocusOut=this.onFocusOut.bind(this)}static get observedAttributes(){return["inactive"]}get inactive(){return this.hasAttribute("inactive")}set inactive(t){t?this.setAttribute("inactive",""):this.removeAttribute("inactive")}get focused(){return this._focused}connectedCallback(){this.$start.addEventListener("focus",this.focusLastElement),this.$end.addEventListener("focus",this.focusFirstElement),this.addEventListener("focusin",this.onFocusIn),this.addEventListener("focusout",this.onFocusOut),this.render()}disconnectedCallback(){this.$start.removeEventListener("focus",this.focusLastElement),this.$end.removeEventListener("focus",this.focusFirstElement),this.removeEventListener("focusin",this.onFocusIn),this.removeEventListener("focusout",this.onFocusOut)}attributeChangedCallback(){this.render()}focusFirstElement(){this.trapFocus()}focusLastElement(){this.trapFocus(!0)}getFocusableElements(){return v(this,k,oe)}trapFocus(t){if(this.inactive)return;let s=this.getFocusableElements();s.length>0?(t?s[s.length-1].focus():s[0].focus(),this.$backup.setAttribute("tabindex","-1")):(this.$backup.setAttribute("tabindex","0"),this.$backup.focus())}onFocusIn(){this.updateFocused(!0)}onFocusOut(){this.updateFocused(!1)}updateFocused(t){ie(()=>{this.focused!==t&&(this._focused=t,this.render())},0,this.debounceId)}render(){this.$start.setAttribute("tabindex",!this.focused||this.inactive?"-1":"0"),this.$end.setAttribute("tabindex",!this.focused||this.inactive?"-1":"0"),this.focused?this.setAttribute("focused",""):this.removeAttribute("focused")}}window.customElements.define("focus-trap",ae);const re=["aria-hidden","role"],le=L({inheritAttrs:!1,__name:"Popup",props:z({target:{},sizing:{type:Function},closeOnFocusLoss:{type:Boolean,default:!0},offset:{default:6},placement:{},role:{}},{modelValue:{type:Boolean,default:!1},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const t=B(e,"modelValue"),s=A(),{floatingStyles:u,isPositioned:a}=R(V(()=>e.target),s,{open:t,placement:e.placement,middleware:[N(e.offset),U(),K({apply({rects:o}){e.sizing&&s.value&&Object.assign(s.value.style,e.sizing(o))}}),P()],whileElementsMounted:W}),r=o=>{o.code===p.Esc&&(t.value=!1)};j(a,o=>{o||(window.removeEventListener("keydown",r),e.target?.focus()),window.addEventListener("keydown",r),requestAnimationFrame(()=>{const c=s.value;if(!c)return;(te(c)??c)?.focus()})});const d=o=>{e.closeOnFocusLoss&&requestAnimationFrame(()=>{(!s.value||!y(s.value))&&(t.value=!1)})},b=()=>{t.value=!1};return(o,c)=>(E(),$(G,{to:"#app"},[t.value?(E(),T("div",{key:0,class:"fixed inset-0 z-20",onClick:c[0]||(c[0]=i=>t.value=!1)})):x("",!0),t.value?(E(),T("focus-trap",J({key:1},o.$attrs,{ref_key:"popup",ref:s,style:Q(u),class:"scrollbar-thin absolute z-20 overscroll-contain rounded-4 border border-neutral-300 bg-neutral-0 shadow-l contain-content",tabindex:"-1","aria-hidden":!t.value,role:o.role,onFocusout:d}),[M(o.$slots,"default",{close:b})],16,re)):x("",!0)]))}});export{le as _,ce as a,_ as f};
