import{d as c,s as k,T as v,x as T,h as f,O as S,j as P,o as V,b,p as w,k as g,u as r,B as U,_ as d}from"./popup-Bk9gj0yf.js";import{_ as H,S as $,a as h,b as q}from"./ProxyNameTextfield.vue_vue_type_script_setup_true_lang-BJ1vzIl5.js";const L={"target:auth":"host:port:user:pass","target@auth":"host:port@user:pass","auth:target":"user:pass:host:port","auth@target":"user:pass@host:port"},O=(l,m)=>{switch(L[l]){case"host:port@user:pass":{const[a,t=""]=m.split("@"),[p,u]=a.split(":"),[n,i,e]=t.split(":");return[p,u,n,i,e]}case"user:pass@host:port":{const a=m.split("@");if(a.length===1){const[o,x]=a[0].split(":");return[o,x]}const[t,p=""]=a,[u,n]=t.split(":"),[i,e,s]=p.split(":");return[i,e,u,n,s]}case"host:port:user:pass":{const[a,t,p,u,n]=m.split(":");return[a,t,p,u,n]}case"user:pass:host:port":{const a=m.split(":");if(a.length===2){const[e,s]=a;return[e,s]}const[t,p,u,n,i]=m.split(":");return[u,n,t,p,i]}default:throw new Error(`Unknown format: ${l}`)}},B=(l,m)=>{const[y,a,t,p,u]=O(m.format,l);if(u!==void 0)return null;const n=Number(a);return!y||!n||!Number.isInteger(n)||m.authRequired&&(!t||!p)?null:{hostname:y,port:n,username:t,password:p}},R=c({__name:"Layout",props:{title:{},data:{}},emits:["back","submit"],setup(l,{emit:m}){const y=m,a=k(l.data?.name??""),t=v({type:l.data?.proxy.type??"http",username:l.data?.proxy.username,password:l.data?.proxy.password,host:l.data?.proxy.host,port:l.data?.proxy.port??1,bypassList:l.data?.proxy.bypassList}),p=[{value:"http",label:"HTTP|HTTPS"},{value:"socks5",label:"SOCKS5"}],u=e=>{const s=e.clipboardData?.getData("text/plain")?.trim();if(!s)return;const o=B(s,{format:"target:auth"});o&&requestAnimationFrame(()=>{t.host=o.hostname,t.port=o.port,t.username=o.username,t.password=o.password})},n=T(()=>t.type==="http"),i=()=>{if(t.type===void 0||t.host===void 0||t.port===void 0)throw new Error("Invalid proxy configuration");let e,s;n.value&&(e=t.username,s=t.password),y("submit",{name:a.value,proxy:{type:t.type,host:t.host,port:t.port,username:e,password:s,bypassList:[]}})};return(e,s)=>(V(),f(S,{title:e.title,onBack:s[6]||(s[6]=o=>y("back"))},{actions:P(()=>[g(e.$slots,"actions")]),default:P(()=>[b(r(q),{onSubmit:i},{default:P(()=>[b(H,{modelValue:r(a),"onUpdate:modelValue":s[0]||(s[0]=o=>U(a)?a.value=o:null)},null,8,["modelValue"]),b(r($),{modelValue:t.type,"onUpdate:modelValue":s[1]||(s[1]=o=>t.type=o),name:"type",required:"","label-key":"label","value-key":"value","label-tooltip":r(n)?"":("m"in e?e.m:r(d)).extensionProxyProtocolSocks5Tooltip(),label:("m"in e?e.m:r(d)).extensionProxyProtocol(),options:p},null,8,["modelValue","label-tooltip","label"]),b(r(h),{modelValue:t.host,"onUpdate:modelValue":s[2]||(s[2]=o=>t.host=o),name:"host",label:("m"in e?e.m:r(d)).extensionProxyHostname(),required:"","max-length":255,"label-tooltip":("m"in e?e.m:r(d)).extensionProxyHostnameTooltip(),onPaste:u},null,8,["modelValue","label","label-tooltip"]),b(r(h),{modelValue:t.port,"onUpdate:modelValue":s[3]||(s[3]=o=>t.port=o),name:"port",label:("m"in e?e.m:r(d)).extensionProxyPort(),type:"number",required:"",min:1,max:1e5},null,8,["modelValue","label"]),r(n)?(V(),f(r(h),{key:0,modelValue:t.username,"onUpdate:modelValue":s[4]||(s[4]=o=>t.username=o),name:"username",label:("m"in e?e.m:r(d)).extensionProxyUsername(),"max-length":255},null,8,["modelValue","label"])):w("",!0),r(n)?(V(),f(r(h),{key:1,modelValue:t.password,"onUpdate:modelValue":s[5]||(s[5]=o=>t.password=o),name:"password",label:("m"in e?e.m:r(d)).extensionProxyPassword(),"max-length":255},null,8,["modelValue","label"])):w("",!0),g(e.$slots,"default")]),_:3})]),_:3},8,["title"]))}});export{R as _};
